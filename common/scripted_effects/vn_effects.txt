 
refresh_subject_count_loyalty_penalty = {
    every_subject = {
		erase_modifier = { MOD = divided_patronage }
	}
	if = {
		limit = {
			NOR = {
				has_civic = civic_feudal_realm
				has_civic = civic_franchising
				has_ascension_perk = ap_shared_destiny
			}
			subjects > 1
		}
		set_variable = { which = subjects_minus_one value = trigger:subjects }
		subtract_variable = { which = subjects_minus_one value = 1 }
		every_subject = {
			add_modifier = {
				modifier = divided_patronage
				multiplier = PREV.subjects_minus_one
			}
		}
		clear_variable = subjects_minus_one
	
	   else = {
	        set_variable = { which = subjects_minus_one_half value = trigger:subjects }
	        set_variable = { which = diff1 value = trigger:subjects }
	        change_variable = { which = diff1 value = 1 }
	        multiply_variable = { which = diff1 value = 0.5 }
	        subtract_variable = { which = subjects_minus_one_half value = diff1 }
	        every_subject = {
	        	#erase_modifier = { MOD = divided_patronage }
	        add_modifier = {
				modifier = divided_patronage
				multiplier = PREV.subjects_minus_one_half
		        }
		    }
	       clear_variable = subjects_minus_one_half
	       clear_variable = diff1
	     }
	}
}

vn_add_empire_size_penalty = {
	
	erase_modifier = { MOD = vn_empire_size_mods }
    set_variable = { which = subject_weight value = 0 }
	
	set_variable = { which = subject_weight value = 0  }
	every_subject = { 
		  prev = {
			      change_variable = { which = subject_weight value = 0.25 }
			  }
	}
    
	log = "!!!!!!!!!! Vassal Weight: \\[This.subject_weight]" 
	
	add_modifier = {
	              modifier = vn_empire_size_mods
	              multiplier = subject_weight
	           }
	
	#log = "!!!!!!!!!!!!!!! Name: [Root.target.GetName]."
	clear_variable = subject_weight
	
	
}

vn_add_stat = {
  	log = "!!!!!!!!!!!!!!! Subject Name: [This.owner.GetName]."
}
